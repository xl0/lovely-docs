<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>sveltejs/svelte – lovely-docs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="sveltejs/svelte – lovely-docs">
<meta property="og:site_name" content="lovely-docs">
<meta name="twitter:title" content="sveltejs/svelte – lovely-docs">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">lovely-docs</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sveltejs-svelte.html">sveltejs/svelte</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">lovely-docs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utils</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sveltejs-svelte.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">sveltejs/svelte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-generator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web Generator</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="sveltejs-svelte.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">sveltejs/svelte</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div id="cell-2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>source <span class="op">=</span> settings.sources[<span class="st">"sveltejs/svelte"</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">isinstance</span>(source, GitSource)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>clone_repo(source)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>clone_dir <span class="op">=</span> settings.git_dir <span class="op">/</span> source.name</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>doc_dir_path <span class="op">=</span> clone_dir <span class="op">/</span> source.doc_dir</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_files_from_fs(root):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    files <span class="op">=</span> []</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> root.rglob(<span class="st">'*'</span>):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path.is_file():</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            rel_path <span class="op">=</span> path.relative_to(root)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            depth <span class="op">=</span> <span class="bu">len</span>(rel_path.parts) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            files.append((depth, <span class="bu">str</span>(rel_path)))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    files.sort(key<span class="op">=</span><span class="kw">lambda</span> x: (x[<span class="dv">0</span>], x[<span class="dv">1</span>]))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [f[<span class="dv">1</span>] <span class="cf">for</span> f <span class="kw">in</span> files]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> get_files_from_fs(doc_dir_path)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>files[:<span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>['index.md',
 '01-introduction/01-overview.md',
 '01-introduction/02-getting-started.md',
 '01-introduction/03-svelte-files.md',
 '01-introduction/04-svelte-js-files.md',
 '01-introduction/index.md',
 '02-runes/01-what-are-runes.md',
 '02-runes/02-$state.md',
 '02-runes/03-$derived.md',
 '02-runes/04-$effect.md']</code></pre>
</div>
</div>
<div id="cell-4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> llm.get_async_model(settings.model)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model.key <span class="op">=</span> settings.api_key</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># await (await model.prompt("Reply with ok")).text()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def wrap_doc(doc: str, name: str):</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     return f"""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;page {name}&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># {doc}</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;/page&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># """.strip()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with open(clone_dir / source.doc_dir / files[2]) as f:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     doc = f.read()</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     wrapped = wrap_doc(doc, files[2])</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # print(wrapped)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReplySchema(BaseModel):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    better_filename: <span class="bu">str</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    summary_markdown: <span class="bu">str</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    short_summary_markdown: <span class="bu">str</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    one_line_summary_txt: <span class="bu">str</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    relevant: <span class="bu">bool</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># prompt = f"""</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read this file, it's part of the documentation for a library. Then:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - Come up with a short filename that perfectly encompasses the contents. It's ok to keep the original if it's good already.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Then write 3 versions of the summary:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   1. Extract bits that are important to a programmer. Don't include any extra notes. Be concise. One example per use case max.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   2. Shorter summary, keep only the most important bits.</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   3. One-line summary of the file.</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - Decide if the content of this file is relevant to a programmer who is already somewhat familiar with the library in question.</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># \n{wrapped}</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># """</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># res = await (await model.prompt(prompt=prompt, schema=ReplySchema))</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># r = ReplySchema.model_validate_json(await res.text())</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r.better_filename)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r.summary_markdown)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r.short_summary_markdown)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r.one_line_summary_txt)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r.relevant)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># await res.usage()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-11" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># async def process_doc(filename: str) -&gt; tuple[ReplySchema, Usage]:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     with open(clone_dir / source.doc_dir / filename) as f:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#         doc = f.read()</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#         wrapped = wrap_doc(doc, filename)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     prompt = f"""</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     Read this file, it's part of the documentation for a library. Then:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     - Come up with a short filename that perfectly encompasses the contents. It's ok to keep the original if it's good already. Don't incluide the name of the library in the name.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     - Then write 3 versions of the summary:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     1. Extract bits that are important to a programmer. Don't include any extra notes. Be concise. One example per use case max.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     2. Shorter summary, keep only the most important bits.</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     3. One-line summary of the file.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     - Decide if the content of this file is relevant to a programmer who is already somewhat familiar with the library in question.</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     \n{wrapped}</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     res = await (await model.prompt(prompt=prompt, schema=ReplySchema))</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     reply = ReplySchema.model_validate_json(await res.text())</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     usage = await res.usage()</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     return reply, usage</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-12" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># r, u = await process_doc(files[3])</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print(" ---\n", r.better_filename)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(" ---\n", r.summary_markdown)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print(" ---\n", r.short_summary_markdown)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print(" ---\n", r.one_line_summary_txt)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r.relevant)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-13" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up Jinja environment</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>jinja_env <span class="op">=</span> Environment(loader<span class="op">=</span>FileSystemLoader(settings.templates_dir))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> process_doc_jinja(filename: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[ReplySchema, Usage]:</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(clone_dir <span class="op">/</span> source.doc_dir <span class="op">/</span> filename) <span class="im">as</span> f:</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        doc <span class="op">=</span> f.read()</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load and render template</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    template <span class="op">=</span> jinja_env.get_template(<span class="st">"process_doc.j2"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    prompt <span class="op">=</span> template.render(text<span class="op">=</span>doc, filename<span class="op">=</span>filename)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="cf">await</span> (<span class="cf">await</span> model.prompt(prompt<span class="op">=</span>prompt, schema<span class="op">=</span>ReplySchema))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    reply <span class="op">=</span> ReplySchema.model_validate_json(<span class="cf">await</span> res.text())</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    usage <span class="op">=</span> <span class="cf">await</span> res.usage()</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reply, usage</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-14" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the Jinja-based version</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>r_jinja, u_jinja <span class="op">=</span> <span class="cf">await</span> process_doc_jinja(files[<span class="dv">3</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" ---</span><span class="ch">\n</span><span class="st">"</span>, r_jinja.better_filename)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" ---</span><span class="ch">\n</span><span class="st">"</span>, r_jinja.summary_markdown)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" ---</span><span class="ch">\n</span><span class="st">"</span>, r_jinja.short_summary_markdown)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" ---</span><span class="ch">\n</span><span class="st">"</span>, r_jinja.one_line_summary_txt)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r_jinja.relevant)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> ---
 svelte-file-structure.md
 ---
 ## Svelte File Structure

`.svelte` files contain components written as a superset of HTML with three optional sections: `&lt;script&gt;`, `&lt;style&gt;`, and markup.

### `&lt;script&gt;` Block
- Contains JavaScript or TypeScript (add `lang="ts"` attribute)
- Runs when a component instance is created
- Top-level variables are accessible in markup
- Use runes to declare component props and add reactivity

### `&lt;script module&gt;` Block
- Runs once when the module first evaluates, not per instance
- Variables declared here can be referenced elsewhere in the component (one-way)
- Can `export` bindings from this block; these become module exports
- Cannot use `export default` (reserved for the component itself)
- TypeScript support: ensure editor setup recognizes exports (supported by Svelte VS Code extension and IntelliJ plugin)

### `&lt;style&gt;` Block
- CSS is scoped to the component only
- Selectors only affect elements within that component
- Example:
```svelte
&lt;style&gt;
  p { color: burlywood; } /* only affects &lt;p&gt; in this component */
&lt;/style&gt;
```
 ---
 ## Svelte File Structure

`.svelte` files have three optional sections:

- **`&lt;script&gt;`** — JavaScript/TypeScript run per instance; access variables in markup
- **`&lt;script module&gt;`** — JavaScript/TypeScript run once at module load; export bindings
- **`&lt;style&gt;`** — Scoped CSS affecting only elements in that component
 ---
 Overview of the three optional sections in .svelte component files: script, module script, and scoped styles.
True</code></pre>
</div>
</div>
<div id="cell-15" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DocPage(BaseModel):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Represents a single documentation page"""</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    filename: <span class="bu">str</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    original_path: <span class="bu">str</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    better_filename: <span class="bu">str</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    summary_markdown: <span class="bu">str</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    short_summary_markdown: <span class="bu">str</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    one_line_summary_txt: <span class="bu">str</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    relevant: <span class="bu">bool</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    usage: Usage</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DocDirectory(BaseModel):</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Represents a directory in the documentation structure"""</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    better_name: <span class="bu">str</span><span class="op">|</span><span class="va">None</span> <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    pages: <span class="bu">list</span>[DocPage] <span class="op">=</span> []</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    subdirs: <span class="bu">dict</span>[<span class="bu">str</span>, <span class="st">'DocDirectory'</span>] <span class="op">=</span> {}</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    short_summary: <span class="bu">str</span><span class="op">|</span><span class="va">None</span> <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    one_line_summary: <span class="bu">str</span><span class="op">|</span><span class="va">None</span> <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    usage: Usage<span class="op">|</span><span class="va">None</span> <span class="op">=</span> <span class="va">None</span>  <span class="co"># Usage for directory summarization only</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_doc_tree(root_path: Path) <span class="op">-&gt;</span> DocDirectory:</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Build a tree structure mirroring the documentation directory"""</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_tree(path: Path, rel_path: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span>) <span class="op">-&gt;</span> DocDirectory:</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        dir_name <span class="op">=</span> path.name <span class="cf">if</span> rel_path <span class="cf">else</span> <span class="st">"root"</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        doc_dir <span class="op">=</span> DocDirectory(name<span class="op">=</span>dir_name, path<span class="op">=</span>rel_path)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get immediate children only</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">sorted</span>(path.iterdir()):</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> item.is_file() <span class="kw">and</span> item.suffix <span class="op">==</span> <span class="st">'.md'</span>:</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                <span class="co"># We'll process files later, just record them</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                doc_dir.pages.append(DocPage(</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                    filename<span class="op">=</span>item.name,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                    original_path<span class="op">=</span><span class="bu">str</span>(Path(rel_path) <span class="op">/</span> item.name) <span class="cf">if</span> rel_path <span class="cf">else</span> item.name,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                    better_filename<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                    summary_markdown<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>                    short_summary_markdown<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>                    one_line_summary_txt<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                    relevant<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>                    usage<span class="op">=</span>Usage(<span class="bu">input</span><span class="op">=</span><span class="dv">0</span>, output<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>                ))</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> item.is_dir():</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>                subdir_rel <span class="op">=</span> <span class="bu">str</span>(Path(rel_path) <span class="op">/</span> item.name) <span class="cf">if</span> rel_path <span class="cf">else</span> item.name</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>                doc_dir.subdirs[item.name] <span class="op">=</span> build_tree(item, subdir_rel)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> doc_dir</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_tree(root_path)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_usage(doc_dir: DocDirectory) <span class="op">-&gt;</span> Usage:</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate total usage for a directory tree including all pages, subdirs, and summaries"""</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    total_input <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    total_output <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add usage from all pages in this directory</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> page <span class="kw">in</span> doc_dir.pages:</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>        total_input <span class="op">+=</span> page.usage.<span class="bu">input</span> <span class="kw">or</span> <span class="dv">0</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>        total_output <span class="op">+=</span> page.usage.output <span class="kw">or</span> <span class="dv">0</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add usage from directory summarization</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> doc_dir.usage:</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>        total_input <span class="op">+=</span> doc_dir.usage.<span class="bu">input</span> <span class="kw">or</span> <span class="dv">0</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>        total_output <span class="op">+=</span> doc_dir.usage.output <span class="kw">or</span> <span class="dv">0</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recursively add usage from subdirectories</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subdir <span class="kw">in</span> doc_dir.subdirs.values():</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>        subdir_usage <span class="op">=</span> calculate_total_usage(subdir)</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>        total_input <span class="op">+=</span> subdir_usage.<span class="bu">input</span> <span class="kw">or</span> <span class="dv">0</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        total_output <span class="op">+=</span> subdir_usage.output <span class="kw">or</span> <span class="dv">0</span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Usage(<span class="bu">input</span><span class="op">=</span>total_input, output<span class="op">=</span>total_output)</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>doc_tree <span class="op">=</span> build_doc_tree(doc_dir_path)</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(doc_tree.model_dump())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'name': 'root', 'path': '', 'better_name': None, 'pages': [{'filename': 'index.md', 'original_path': 'index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {'01-introduction': {'name': '01-introduction', 'path': '01-introduction', 'better_name': None, 'pages': [{'filename': '01-overview.md', 'original_path': '01-introduction/01-overview.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-getting-started.md', 'original_path': '01-introduction/02-getting-started.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-svelte-files.md', 'original_path': '01-introduction/03-svelte-files.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-svelte-js-files.md', 'original_path': '01-introduction/04-svelte-js-files.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '01-introduction/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '02-runes': {'name': '02-runes', 'path': '02-runes', 'better_name': None, 'pages': [{'filename': '01-what-are-runes.md', 'original_path': '02-runes/01-what-are-runes.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-$state.md', 'original_path': '02-runes/02-$state.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-$derived.md', 'original_path': '02-runes/03-$derived.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-$effect.md', 'original_path': '02-runes/04-$effect.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '05-$props.md', 'original_path': '02-runes/05-$props.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '06-$bindable.md', 'original_path': '02-runes/06-$bindable.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '07-$inspect.md', 'original_path': '02-runes/07-$inspect.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '08-$host.md', 'original_path': '02-runes/08-$host.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '02-runes/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '03-template-syntax': {'name': '03-template-syntax', 'path': '03-template-syntax', 'better_name': None, 'pages': [{'filename': '01-basic-markup.md', 'original_path': '03-template-syntax/01-basic-markup.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-if.md', 'original_path': '03-template-syntax/02-if.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-each.md', 'original_path': '03-template-syntax/03-each.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-key.md', 'original_path': '03-template-syntax/04-key.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '05-await.md', 'original_path': '03-template-syntax/05-await.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '06-snippet.md', 'original_path': '03-template-syntax/06-snippet.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '07-@render.md', 'original_path': '03-template-syntax/07-@render.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '08-@html.md', 'original_path': '03-template-syntax/08-@html.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '09-@attach.md', 'original_path': '03-template-syntax/09-@attach.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '10-@const.md', 'original_path': '03-template-syntax/10-@const.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '11-@debug.md', 'original_path': '03-template-syntax/11-@debug.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '12-bind.md', 'original_path': '03-template-syntax/12-bind.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '13-use.md', 'original_path': '03-template-syntax/13-use.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '14-transition.md', 'original_path': '03-template-syntax/14-transition.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '15-in-and-out.md', 'original_path': '03-template-syntax/15-in-and-out.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '16-animate.md', 'original_path': '03-template-syntax/16-animate.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '17-style.md', 'original_path': '03-template-syntax/17-style.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '18-class.md', 'original_path': '03-template-syntax/18-class.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '03-template-syntax/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '04-styling': {'name': '04-styling', 'path': '04-styling', 'better_name': None, 'pages': [{'filename': '01-scoped-styles.md', 'original_path': '04-styling/01-scoped-styles.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-global-styles.md', 'original_path': '04-styling/02-global-styles.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-custom-properties.md', 'original_path': '04-styling/03-custom-properties.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-nested-style-elements.md', 'original_path': '04-styling/04-nested-style-elements.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '04-styling/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '05-special-elements': {'name': '05-special-elements', 'path': '05-special-elements', 'better_name': None, 'pages': [{'filename': '01-svelte-boundary.md', 'original_path': '05-special-elements/01-svelte-boundary.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-svelte-window.md', 'original_path': '05-special-elements/02-svelte-window.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-svelte-document.md', 'original_path': '05-special-elements/03-svelte-document.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-svelte-body.md', 'original_path': '05-special-elements/04-svelte-body.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '05-svelte-head.md', 'original_path': '05-special-elements/05-svelte-head.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '06-svelte-element.md', 'original_path': '05-special-elements/06-svelte-element.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '07-svelte-options.md', 'original_path': '05-special-elements/07-svelte-options.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '05-special-elements/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '06-runtime': {'name': '06-runtime', 'path': '06-runtime', 'better_name': None, 'pages': [{'filename': '01-stores.md', 'original_path': '06-runtime/01-stores.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-context.md', 'original_path': '06-runtime/02-context.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-lifecycle-hooks.md', 'original_path': '06-runtime/03-lifecycle-hooks.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-imperative-component-api.md', 'original_path': '06-runtime/04-imperative-component-api.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '06-runtime/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '07-misc': {'name': '07-misc', 'path': '07-misc', 'better_name': None, 'pages': [{'filename': '02-testing.md', 'original_path': '07-misc/02-testing.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-typescript.md', 'original_path': '07-misc/03-typescript.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-custom-elements.md', 'original_path': '07-misc/04-custom-elements.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '06-v4-migration-guide.md', 'original_path': '07-misc/06-v4-migration-guide.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '07-v5-migration-guide.md', 'original_path': '07-misc/07-v5-migration-guide.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '99-faq.md', 'original_path': '07-misc/99-faq.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '07-misc/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '98-reference': {'name': '98-reference', 'path': '98-reference', 'better_name': None, 'pages': [{'filename': '20-svelte.md', 'original_path': '98-reference/20-svelte.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-action.md', 'original_path': '98-reference/21-svelte-action.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-animate.md', 'original_path': '98-reference/21-svelte-animate.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-attachments.md', 'original_path': '98-reference/21-svelte-attachments.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-compiler.md', 'original_path': '98-reference/21-svelte-compiler.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-easing.md', 'original_path': '98-reference/21-svelte-easing.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-events.md', 'original_path': '98-reference/21-svelte-events.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-legacy.md', 'original_path': '98-reference/21-svelte-legacy.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-motion.md', 'original_path': '98-reference/21-svelte-motion.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-reactivity-window.md', 'original_path': '98-reference/21-svelte-reactivity-window.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-reactivity.md', 'original_path': '98-reference/21-svelte-reactivity.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-server.md', 'original_path': '98-reference/21-svelte-server.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-store.md', 'original_path': '98-reference/21-svelte-store.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-svelte-transition.md', 'original_path': '98-reference/21-svelte-transition.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '30-compiler-errors.md', 'original_path': '98-reference/30-compiler-errors.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '30-compiler-warnings.md', 'original_path': '98-reference/30-compiler-warnings.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '30-runtime-errors.md', 'original_path': '98-reference/30-runtime-errors.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '30-runtime-warnings.md', 'original_path': '98-reference/30-runtime-warnings.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '98-reference/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {'.generated': {'name': '.generated', 'path': '98-reference/.generated', 'better_name': None, 'pages': [{'filename': 'client-errors.md', 'original_path': '98-reference/.generated/client-errors.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'client-warnings.md', 'original_path': '98-reference/.generated/client-warnings.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'compile-errors.md', 'original_path': '98-reference/.generated/compile-errors.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'compile-warnings.md', 'original_path': '98-reference/.generated/compile-warnings.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'server-errors.md', 'original_path': '98-reference/.generated/server-errors.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'shared-errors.md', 'original_path': '98-reference/.generated/shared-errors.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'shared-warnings.md', 'original_path': '98-reference/.generated/shared-warnings.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}}, 'short_summary': None, 'one_line_summary': None, 'usage': None}, '99-legacy': {'name': '99-legacy', 'path': '99-legacy', 'better_name': None, 'pages': [{'filename': '00-legacy-overview.md', 'original_path': '99-legacy/00-legacy-overview.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '01-legacy-let.md', 'original_path': '99-legacy/01-legacy-let.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '02-legacy-reactive-assignments.md', 'original_path': '99-legacy/02-legacy-reactive-assignments.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '03-legacy-export-let.md', 'original_path': '99-legacy/03-legacy-export-let.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '04-legacy-$$props-and-$$restProps.md', 'original_path': '99-legacy/04-legacy-$$props-and-$$restProps.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '10-legacy-on.md', 'original_path': '99-legacy/10-legacy-on.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '20-legacy-slots.md', 'original_path': '99-legacy/20-legacy-slots.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '21-legacy-$$slots.md', 'original_path': '99-legacy/21-legacy-$$slots.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '22-legacy-svelte-fragment.md', 'original_path': '99-legacy/22-legacy-svelte-fragment.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '30-legacy-svelte-component.md', 'original_path': '99-legacy/30-legacy-svelte-component.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '31-legacy-svelte-self.md', 'original_path': '99-legacy/31-legacy-svelte-self.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': '40-legacy-component-api.md', 'original_path': '99-legacy/40-legacy-component-api.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}, {'filename': 'index.md', 'original_path': '99-legacy/index.md', 'better_filename': '', 'summary_markdown': '', 'short_summary_markdown': '', 'one_line_summary_txt': '', 'relevant': False, 'usage': {'input': 0, 'output': 0, 'details': None}}], 'subdirs': {}, 'short_summary': None, 'one_line_summary': None, 'usage': None}}, 'short_summary': None, 'one_line_summary': None, 'usage': None}</code></pre>
</div>
</div>
<div id="cell-16" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DirectorySummarySchema(BaseModel):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    better_name: <span class="bu">str</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    short_summary: <span class="bu">str</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    one_line_summary: <span class="bu">str</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> summarize_directory(dir_name: <span class="bu">str</span>, pages: <span class="bu">list</span>[DocPage], subdirs: <span class="bu">list</span>[DocDirectory]) <span class="op">-&gt;</span> <span class="bu">tuple</span>[DirectorySummarySchema, Usage]:</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Create a summary for a directory based on its relevant pages and subdirectories"""</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    template <span class="op">=</span> jinja_env.get_template(<span class="st">"summarize_directory.j2"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    prompt <span class="op">=</span> template.render(dir_name<span class="op">=</span>dir_name, pages<span class="op">=</span>pages, subdirs<span class="op">=</span>subdirs)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="cf">await</span> (<span class="cf">await</span> model.prompt(prompt<span class="op">=</span>prompt, schema<span class="op">=</span>DirectorySummarySchema))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    summary <span class="op">=</span> DirectorySummarySchema.model_validate_json(<span class="cf">await</span> res.text())</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    usage <span class="op">=</span> <span class="cf">await</span> res.usage()</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> summary, usage</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-17" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> process_tree_depth_first(doc_dir: DocDirectory, root_path: Path) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Process documentation tree depth-first with parallel processing.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns (total_pages_processed, total_relevant_pages)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    total_processed <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    total_relevant <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First, recursively process all subdirectories in parallel</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> doc_dir.subdirs:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        subdir_tasks <span class="op">=</span> [</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>            process_tree_depth_first(subdir, root_path)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> subdir <span class="kw">in</span> doc_dir.subdirs.values()</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        subdir_results <span class="op">=</span> <span class="cf">await</span> asyncio.gather(<span class="op">*</span>subdir_tasks)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sub_processed, sub_relevant <span class="kw">in</span> subdir_results:</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>            total_processed <span class="op">+=</span> sub_processed</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>            total_relevant <span class="op">+=</span> sub_relevant</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Then process all pages in this directory in parallel</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> doc_dir.pages:</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="kw">def</span> process_single_page(page: DocPage, index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">int</span>, DocPage]:</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Processing: </span><span class="sc">{</span>page<span class="sc">.</span>original_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>            reply, usage <span class="op">=</span> <span class="cf">await</span> process_doc_jinja(page.original_path)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> index, DocPage(</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                filename<span class="op">=</span>page.filename,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                original_path<span class="op">=</span>page.original_path,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                better_filename<span class="op">=</span>reply.better_filename,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                summary_markdown<span class="op">=</span>reply.summary_markdown,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                short_summary_markdown<span class="op">=</span>reply.short_summary_markdown,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                one_line_summary_txt<span class="op">=</span>reply.one_line_summary_txt,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                relevant<span class="op">=</span>reply.relevant,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                usage<span class="op">=</span>usage</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>        page_tasks <span class="op">=</span> [</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>            process_single_page(page, i)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, page <span class="kw">in</span> <span class="bu">enumerate</span>(doc_dir.pages)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>        page_results <span class="op">=</span> <span class="cf">await</span> asyncio.gather(<span class="op">*</span>page_tasks)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update pages with results</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> index, processed_page <span class="kw">in</span> page_results:</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>            doc_dir.pages[index] <span class="op">=</span> processed_page</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>            total_processed <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> processed_page.relevant:</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>                total_relevant <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># After processing all pages and subdirs, create directory summary</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    relevant_pages <span class="op">=</span> [p <span class="cf">for</span> p <span class="kw">in</span> doc_dir.pages <span class="cf">if</span> p.relevant]</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    relevant_subdirs <span class="op">=</span> [s <span class="cf">for</span> s <span class="kw">in</span> doc_dir.subdirs.values() <span class="cf">if</span> s.short_summary <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>]</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> relevant_pages <span class="kw">or</span> relevant_subdirs:</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Summarizing directory: </span><span class="sc">{</span>doc_dir<span class="sc">.</span>path <span class="kw">or</span> <span class="st">'root'</span><span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">len</span>(relevant_pages)<span class="sc">}</span><span class="ss"> pages, </span><span class="sc">{</span><span class="bu">len</span>(relevant_subdirs)<span class="sc">}</span><span class="ss"> subdirs)"</span>)</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>        dir_summary, usage <span class="op">=</span> <span class="cf">await</span> summarize_directory(doc_dir.name, relevant_pages, relevant_subdirs)</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>        doc_dir.better_name <span class="op">=</span> dir_summary.better_name</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>        doc_dir.short_summary <span class="op">=</span> dir_summary.short_summary</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>        doc_dir.one_line_summary <span class="op">=</span> dir_summary.one_line_summary</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>        doc_dir.usage <span class="op">=</span> usage</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_processed, total_relevant</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-18" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>doc_tree.subdirs <span class="op">=</span> {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"02-runes"</span> : doc_tree.subdirs[<span class="st">"02-runes"</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>doc_tree.model_dump()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'name': 'root',
 'path': '',
 'better_name': None,
 'pages': [{'filename': 'index.md',
   'original_path': 'index.md',
   'better_filename': '',
   'summary_markdown': '',
   'short_summary_markdown': '',
   'one_line_summary_txt': '',
   'relevant': False,
   'usage': {'input': 0, 'output': 0, 'details': None}}],
 'subdirs': {'02-runes': {'name': '02-runes',
   'path': '02-runes',
   'better_name': None,
   'pages': [{'filename': '01-what-are-runes.md',
     'original_path': '02-runes/01-what-are-runes.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '02-$state.md',
     'original_path': '02-runes/02-$state.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '03-$derived.md',
     'original_path': '02-runes/03-$derived.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '04-$effect.md',
     'original_path': '02-runes/04-$effect.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '05-$props.md',
     'original_path': '02-runes/05-$props.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '06-$bindable.md',
     'original_path': '02-runes/06-$bindable.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '07-$inspect.md',
     'original_path': '02-runes/07-$inspect.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': '08-$host.md',
     'original_path': '02-runes/08-$host.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}},
    {'filename': 'index.md',
     'original_path': '02-runes/index.md',
     'better_filename': '',
     'summary_markdown': '',
     'short_summary_markdown': '',
     'one_line_summary_txt': '',
     'relevant': False,
     'usage': {'input': 0, 'output': 0, 'details': None}}],
   'subdirs': {},
   'short_summary': None,
   'one_line_summary': None,
   'usage': None}},
 'short_summary': None,
 'one_line_summary': None,
 'usage': None}</code></pre>
</div>
</div>
<div id="cell-19" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the entire documentation tree</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>processed, relevant <span class="op">=</span> <span class="cf">await</span> process_tree_depth_first(doc_tree, doc_dir_path)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n\n</span><span class="ss">Total pages processed: </span><span class="sc">{</span>processed<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total relevant pages: </span><span class="sc">{</span>relevant<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing: 02-runes/01-what-are-runes.md
Processing: 02-runes/02-$state.md
Processing: 02-runes/03-$derived.md
Processing: 02-runes/04-$effect.md
Processing: 02-runes/05-$props.md
Processing: 02-runes/06-$bindable.md
Processing: 02-runes/07-$inspect.md
Processing: 02-runes/08-$host.md
Processing: 02-runes/index.md
Summarizing directory: 02-runes (9 pages, 0 subdirs)
Processing: index.md
Summarizing directory: root (0 pages, 1 subdirs)


Total pages processed: 10
Total relevant pages: 9</code></pre>
</div>
</div>
<div id="cell-20" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total usage for the entire tree</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>total_usage <span class="op">=</span> calculate_total_usage(doc_tree)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Total Usage:"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Input tokens: </span><span class="sc">{</span>total_usage<span class="sc">.</span><span class="bu">input</span><span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Output tokens: </span><span class="sc">{</span>total_usage<span class="sc">.</span>output<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Total tokens: </span><span class="sc">{</span>(total_usage.<span class="bu">input</span> <span class="op">+</span> total_usage.output)<span class="sc">:,}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Total Usage:
  Input tokens: 28,530
  Output tokens: 5,536
  Total tokens: 34,066</code></pre>
</div>
</div>
<div id="cell-21" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>doc_tree.model_dump()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'name': 'root',
 'path': '',
 'better_name': 'svelte-reactivity-system',
 'pages': [{'filename': 'index.md',
   'original_path': 'index.md',
   'better_filename': 'index.md',
   'summary_markdown': 'This file is the documentation index/landing page for Svelte. It appears to be a mostly empty template page with only a title defined in the frontmatter. No substantive content about Svelte features, API, guides, or other documentation material is present in this file.',
   'short_summary_markdown': 'Empty documentation index page with only a title specified in frontmatter.',
   'one_line_summary_txt': 'Empty documentation landing page.',
   'relevant': False,
   'usage': {'input': 971, 'output': 188, 'details': None}}],
 'subdirs': {'02-runes': {'name': '02-runes',
   'path': '02-runes',
   'better_name': 'svelte-runes-reference',
   'pages': [{'filename': '01-what-are-runes.md',
     'original_path': '02-runes/01-what-are-runes.md',
     'better_filename': 'runes-overview.md',
     'summary_markdown': "## Runes Overview\n\nRunes are compiler directives with a `$` prefix used in `.svelte`, `.svelte.js`, and `.svelte.ts` files to control Svelte's compiler behavior. They function as language keywords with specific syntax rules.\n\n### Key Characteristics\n\n- **Syntax**: Prefix with `$` and appear function-like: `let message = $state('hello');`\n- **Automatic availability**: No imports needed — built into the language\n- **Non-values**: Cannot be assigned to variables or passed as function arguments\n- **Position-sensitive**: Only valid in certain contexts; compiler validates placement\n\n### Scope\n\n- Introduced in Svelte 5\n- Available in component files (`.svelte`) and JavaScript/TypeScript modules (`.svelte.js`/`.svelte.ts`)",
     'short_summary_markdown': "Runes are compiler keywords prefixed with `$` (e.g., `$state()`) used to control Svelte's behavior. They're built-in, cannot be assigned to variables, and are position-sensitive with compiler validation. Introduced in Svelte 5.",
     'one_line_summary_txt': 'Runes are $ -prefixed compiler keywords in Svelte that control the compiler behavior, similar to language syntax rather than regular functions.',
     'relevant': True,
     'usage': {'input': 1215, 'output': 389, 'details': None}},
    {'filename': '02-$state.md',
     'original_path': '02-runes/02-$state.md',
     'better_filename': 'state-rune-guide.md',
     'summary_markdown': "## Summary\n\nThe `$state` rune creates reactive state that automatically updates the UI when changed. Unlike other frameworks, state values are plain JavaScript values (numbers, arrays, objects) that you mutate directly.\n\n### Deep Reactivity\n- Arrays and simple objects are deeply reactive proxies — modifying nested properties (`todos[0].done = true`) triggers granular updates\n- Proxification is recursive until non-simple types (classes, `Object.create` instances) are encountered\n- Destructuring reactive values breaks reactivity at that point; references become static\n\n### `$state.raw`\nUse when you don't want deep reactivity or need performance optimization. State must be _reassigned_ rather than mutated:\n```js\nlet person = $state.raw({ name: 'John', age: 30 });\nperson.age = 31; // has no effect\nperson = { name: 'John', age: 31 }; // works\n```\n\n### Classes\nClass instances aren't proxied. Instead, declare `$state` on class fields:\n```js\nclass Todo {\n  done = $state(false);\n  constructor(text) {\n    this.text = $state(text);\n  }\n  reset = () =&gt; { /* uses arrow function to preserve `this` */ }\n}\n```\n\n### `$state.snapshot`\nConverts a reactive proxy to a static snapshot for external libraries:\n```js\n$state.snapshot(counter) // returns plain object, not Proxy\n```\n\n### Passing State Across Modules\nState can only be exported if not directly reassigned. Use these patterns:\n- Export an object containing the state: `export const counter = $state({ count: 0 })`\n- Export accessor functions: `export function getCount() { return count; }`\n\nNever export a directly-reassigned state variable, as the compiler transforms `$state` references per-file and won't apply transforms to imported references.",
     'short_summary_markdown': '## Summary\n\nThe `$state` rune creates reactive state. Plain values update directly; arrays/objects become deeply reactive proxies that trigger granular updates on nested property changes.\n\nKey variants:\n- **`$state`** — Deep reactivity for arrays and objects\n- **`$state.raw`** — Non-reactive state, must reassign instead of mutate\n- **`$state.snapshot`** — Convert proxy to plain object\n\nIn classes, apply `$state` to field declarations. When sharing state across modules, either export a container object or use accessor functions—never directly export and reassign a `$state` variable.',
     'one_line_summary_txt': 'The $state rune creates reactive state that updates the UI automatically, with deep reactivity for objects/arrays and variants for raw state and snapshots.',
     'relevant': True,
     'usage': {'input': 3563, 'output': 720, 'details': None}},
    {'filename': '03-$derived.md',
     'original_path': '02-runes/03-$derived.md',
     'better_filename': 'derived_rune.md',
     'summary_markdown': '## $derived Rune\n\nDerived state is created with the `$derived` rune for automatic calculations based on state changes:\n\n```svelte\nlet count = $state(0);\nlet doubled = $derived(count * 2);\n```\n\n**Key features:**\n- Expressions must be side-effect free (no state mutations like `count++`)\n- Automatically recalculates when dependencies change\n- Can mark class fields as `$derived`\n\n**$derived.by for complex logic:**\n```svelte\nlet total = $derived.by(() =&gt; {\n\tlet sum = 0;\n\tfor (const n of numbers) sum += n;\n\treturn sum;\n});\n```\n\n**Dependency tracking:** Anything read synchronously inside the expression is a dependency. Use `untrack` to exempt values.\n\n**Overriding values:** Can reassign derived values (if not declared with `const`) for optimistic UI patterns:\n```svelte\nlet likes = $derived(post.likes);\nasync function onclick() {\n\tlikes += 1; // immediate feedback\n\ttry { await like(); }\n\tcatch { likes -= 1; } // rollback on failure\n}\n```\n\n**Reactivity notes:**\n- `$derived` values are not deeply reactive proxies (unlike `$state`)\n- Mutating properties of a derived value affects the underlying source\n- Uses push-pull reactivity: state changes notify dependents immediately, but derived values only re-evaluate when read\n- Downstream updates skip if new derived value is referentially identical to previous value',
     'short_summary_markdown': 'The `$derived` rune creates reactive derived state that automatically recalculates when dependencies change. Use `$derived(expression)` for simple cases or `$derived.by(() =&gt; {...})` for complex logic. Derived values can be temporarily overridden for optimistic UI and use push-pull reactivity for efficient updates.',
     'one_line_summary_txt': '$derived rune creates automatic calculated state that recalculates when dependencies change, with support for complex logic and optimistic UI patterns.',
     'relevant': True,
     'usage': {'input': 2703, 'output': 564, 'details': None}},
    {'filename': '04-$effect.md',
     'original_path': '02-runes/04-$effect.md',
     'better_filename': '$effect-rune-guide.md',
     'summary_markdown': "## $effect Rune Documentation\n\n### Core Concept\n`$effect` is a rune that runs functions when reactive state updates. Effects execute in the browser (not during SSR) and are used for side effects like third-party library calls, canvas manipulation, and network requests. State updates should generally be avoided within effects to prevent infinite loops.\n\n### Key Mechanics\n- Effects automatically track synchronously-read reactive values (`$state`, `$derived`, `$props`) and re-run when dependencies change\n- Run after component mounting and in microtasks after state changes\n- Multiple state changes in the same moment batch into a single re-run\n- Effects can return a teardown function that runs before re-runs and on component destruction\n- Only reruns when objects change, not when properties inside them change (unless the property itself is directly accessed)\n\n### Dependency Tracking\n- Automatic tracking of synchronously-read reactive values\n- Asynchronously-read values (after `await` or `setTimeout`) are NOT tracked\n- Conditional code affects dependencies: only values read in the executed path are tracked\n- When re-running, only previously-read dependencies trigger reruns\n\n### Variants\n- **`$effect.pre`**: Runs code before DOM updates (use `tick()` for post-DOM operations)\n- **`$effect.tracking()`**: Advanced - returns boolean indicating if code runs in a tracking context\n- **`$effect.root`**: Advanced - creates non-tracked scope with manual cleanup for effects outside component initialization\n\n### Lifecycle\nEffects run after DOM mounting in microtasks after state changes. Teardown functions execute:\n1. Immediately before effect re-runs\n2. When component/parent effect is destroyed\n\n### Anti-patterns to Avoid\n- **Don't update state**: Use `$derived` for computed values instead of effects that write state\n- **Don't link values**: Use `$derived` or function bindings rather than multiple effects updating each other\n- **Don't create infinite loops**: If you must read and write the same state in an effect, use `untrack()`\n\n### Use Cases\n- Canvas drawing and direct DOM manipulation\n- Analytics and third-party integrations\n- Network requests and timers\n- Autoscroll behavior and similar DOM-based interactions",
     'short_summary_markdown': '## $effect Rune\n\n`$effect` runs side-effect functions when reactive state changes. It automatically tracks synchronously-read reactive values and reruns when they change. Effects can return teardown functions for cleanup. Variants include `$effect.pre` (runs before DOM updates) and advanced features like `$effect.tracking()` and `$effect.root`. Avoid using effects for state synchronization—use `$derived` instead.',
     'one_line_summary_txt': '$effect rune for running side effects when reactive state changes, with automatic dependency tracking and lifecycle management.',
     'relevant': True,
     'usage': {'input': 6930, 'output': 733, 'details': None}},
    {'filename': '05-$props.md',
     'original_path': '02-runes/05-$props.md',
     'better_filename': 'component-props-rune.md',
     'summary_markdown': '## Component Props with the `$props` Rune\n\nThe `$props` rune receives component inputs (props) passed from parent components. Props are passed like element attributes and received using destructuring assignment.\n\n### Basic Usage\n```svelte\n// Parent: &lt;MyComponent adjective="cool" /&gt;\n// Child:\nlet { adjective } = $props();\n```\n\n### Key Features\n\n**Fallback Values** — Provide defaults when props aren\'t set:\n```js\nlet { adjective = \'happy\' } = $props();\n```\n\n**Renaming Props** — Use destructuring to rename invalid identifiers or keywords:\n```js\nlet { super: trouper = \'lights are gonna find me\' } = $props();\n```\n\n**Rest Props** — Capture remaining props:\n```js\nlet { a, b, c, ...others } = $props();\n```\n\n### Prop Updates and Mutations\n- Child components can temporarily reassign props, which updates when the parent\'s prop changes\n- **Do not mutate regular object props** — mutations have no effect\n- **Do not mutate reactive state props** — causes an `ownership_invalid_mutation` warning; use callbacks or `$bindable` instead\n- Fallback values are not turned into reactive proxies, so mutations on them have no effect\n\n### Type Safety\nAdd type annotations for better IDE support and documentation:\n```svelte\n&lt;script lang="ts"&gt;\n\tlet { adjective }: { adjective: string } = $props();\n&lt;/script&gt;\n```\n\nOr use JSDoc in JavaScript:\n```svelte\n/** @type {{ adjective: string }} */\nlet { adjective } = $props();\n```\n\n### `$props.id()`\nGenerates a unique, hydration-stable ID for the current component instance. Useful for linking elements with `for`, `aria-labelledby`, etc.:\n```svelte\nconst uid = $props.id();\n// &lt;label for="{uid}-firstname"&gt;...&lt;/label&gt;\n// &lt;input id="{uid}-firstname" /&gt;\n```',
     'short_summary_markdown': "## Component Props with the `$props` Rune\n\nReceive component inputs using the `$props()` rune with destructuring. Supports fallback values, prop renaming, and rest parameters.\n\n**Key rules:**\n- Child components can reassign but shouldn't mutate regular object props\n- Mutating reactive state props causes warnings — use callbacks or `$bindable` instead\n- Add TypeScript or JSDoc type annotations for type safety\n- Use `$props.id()` for generating unique, hydration-stable IDs",
     'one_line_summary_txt': 'The `$props` rune receives and destructures component inputs with support for defaults, renaming, and type safety.',
     'relevant': True,
     'usage': {'input': 3893, 'output': 725, 'details': None}},
    {'filename': '06-$bindable.md',
     'original_path': '02-runes/06-$bindable.md',
     'better_filename': 'bindable-props-bidirectional-data-flow.md',
     'summary_markdown': "## $bindable Rune for Two-Way Data Binding\n\n### Overview\nThe `$bindable` rune enables component props to flow bidirectionally—from parent to child and back up. This allows child components to update parent state while maintaining controlled data flow.\n\n### Key Concepts\n- **Default behavior**: Props flow one-way (parent → child)\n- **With $bindable**: Data can flow both directions, simplifying code when used carefully\n- **State mutation**: Bindable props allow state proxies to be mutated in child components\n- **Warning**: Mutation of non-owned state triggers Svelte warnings; use sparingly\n\n### Usage\nMark a prop as bindable using the `$bindable()` rune in the prop declaration:\n\n```svelte\n// In child component\nlet { value = $bindable(), ...props } = $props();\n&lt;input bind:value={value} {...props} /&gt;\n```\n\nParent components can then use the `bind:` directive to establish two-way binding:\n\n```svelte\n// In parent component\nlet message = $state('hello');\n&lt;FancyInput bind:value={message} /&gt;\n```\n\n### Optional Behavior\n- Parent components **don't have to use `bind:`** — they can pass normal props instead\n- Specify fallback values for when no prop is passed: `value = $bindable('fallback')`",
     'short_summary_markdown': '## $bindable: Two-Way Prop Binding\n\nThe `$bindable` rune enables bidirectional data flow between parent and child components, allowing children to update parent state via the `bind:` directive.\n\n### Quick Example\n```svelte\n// Child: declare bindable prop\nlet { value = $bindable() } = $props();\n\n// Parent: use bind: directive\n&lt;FancyInput bind:value={message} /&gt;\n```\n\nUse sparingly—mutation of child-modified props is intentional but should be carefully considered.',
     'one_line_summary_txt': 'The $bindable rune enables two-way data binding on component props, allowing child components to update parent state when used with the bind: directive.',
     'relevant': True,
     'usage': {'input': 1780, 'output': 582, 'details': None}},
    {'filename': '07-$inspect.md',
     'original_path': '02-runes/07-$inspect.md',
     'better_filename': '$inspect-rune-debugging',
     'summary_markdown': '## $inspect Rune\n\nThe `$inspect` rune is a development-only debugging tool that logs values whenever their reactive state changes (similar to `console.log`). It tracks reactive state deeply, including changes within objects and arrays.\n\n**Basic Usage:**\n```svelte\nlet count = $state(0);\n$inspect(count); // logs whenever count changes\n```\n\n**Custom Handler with `.with()`:**\n`$inspect` returns a `with` property that accepts a callback with signature `(type, ...values)` where `type` is either `"init"` or `"update"`:\n```svelte\nlet count = $state(0);\n$inspect(count).with((type, count) =&gt; {\n  if (type === \'update\') {\n    debugger; // or console.trace()\n  }\n});\n```\n\nYou can use `$inspect(stuff).with(console.trace)` to track where changes originate.\n\n**$inspect.trace() (v5.14+):**\nTraces which reactive state caused a function to re-run within effects or derived values. Must be the first statement in a function body:\n```svelte\n$effect(() =&gt; {\n  $inspect.trace(); // optional label: $inspect.trace(\'label\')\n  doSomeWork();\n});\n```\n\nNote: `$inspect` is a no-op in production builds.',
     'short_summary_markdown': '## $inspect Rune\n\nDevelopment-only debugging rune that logs reactive values whenever they change, similar to `console.log` but with deep reactivity tracking.\n\n**Main features:**\n- Basic logging: `$inspect(count)` logs on state changes\n- Custom handlers: `$inspect(count).with((type, value) =&gt; {})` where type is `"init"` or `"update"`\n- Tracing: `$inspect.trace()` (v5.14+) identifies which reactive state triggered an effect/derived re-run (must be first statement in function)\n\nNo-op in production.',
     'one_line_summary_txt': 'Development debugging rune that logs reactive state changes and can trace what causes effects/derived values to re-run.',
     'relevant': True,
     'usage': {'input': 2084, 'output': 588, 'details': None}},
    {'filename': '08-$host.md',
     'original_path': '02-runes/08-$host.md',
     'better_filename': 'host-element-access.md',
     'summary_markdown': '## $host Rune for Custom Elements\n\nThe `$host` rune provides access to the host element when compiling a component as a custom element. This allows you to interact with the host element directly, such as dispatching custom events.\n\n### Use Case: Dispatching Custom Events\n\nWhen building custom elements, use `$host()` to dispatch events that parent components can listen to:\n\n```svelte\n&lt;svelte:options customElement="my-stepper" /&gt;\n\n&lt;script&gt;\n\tfunction dispatch(type) {\n\t\t$host().dispatchEvent(new CustomEvent(type));\n\t}\n&lt;/script&gt;\n\n&lt;button onclick={() =&gt; dispatch(\'decrement\')}&gt;decrement&lt;/button&gt;\n&lt;button onclick={() =&gt; dispatch(\'increment\')}&gt;increment&lt;/button&gt;\n```\n\nParent components can then handle these events:\n\n```svelte\n&lt;my-stepper\n\tondecrement={() =&gt; count -= 1}\n\tonincrement={() =&gt; count += 1}\n&gt;&lt;/my-stepper&gt;\n```',
     'short_summary_markdown': '## $host Rune\n\nThe `$host` rune provides access to the host element in custom elements, enabling you to dispatch custom events that parent components can listen to.\n\nExample:\n```svelte\n&lt;svelte:options customElement="my-component" /&gt;\n$host().dispatchEvent(new CustomEvent(\'my-event\'));\n```',
     'one_line_summary_txt': 'The $host rune allows custom element components to access their host element and dispatch events to parent consumers.',
     'relevant': True,
     'usage': {'input': 1603, 'output': 436, 'details': None}},
    {'filename': 'index.md',
     'original_path': '02-runes/index.md',
     'better_filename': 'runes.md',
     'summary_markdown': '## Runes\n\nThis page appears to be an index or landing page for documentation about runes in the library.\n\n**Note:** The provided content only includes the front matter (title metadata) without the actual documentation body. The page is titled "Runes" but the detailed content explaining what runes are, how to use them, and relevant examples is not included in this excerpt.\n\nTo provide a comprehensive summary, the actual page content would be needed.',
     'short_summary_markdown': 'Index page for runes documentation. Content not provided in excerpt.',
     'one_line_summary_txt': 'Documentation index page for runes.',
     'relevant': True,
     'usage': {'input': 977, 'output': 227, 'details': None}}],
   'subdirs': {},
   'short_summary': "Runes are compiler keywords (prefixed with `$`) that control Svelte 5's reactivity system. They enable reactive state management with `$state`, computed values with `$derived`, side-effects with `$effect`, bidirectional prop binding with `$bindable`, and component communication patterns. Each rune serves a specific purpose in building reactive applications, from creating deeply-reactive proxies to handling component inputs and custom element integration.",
   'one_line_summary': 'Runes are built-in compiler keywords that provide reactive state, derived values, side-effects, props, and debugging utilities for Svelte 5 applications.',
   'usage': {'input': 1816, 'output': 206, 'details': None}}},
 'short_summary': "Runes are Svelte 5's compiler keywords that form the foundation of its reactivity system. They provide reactive state management ($state), computed values ($derived), side-effects ($effect), and component communication patterns ($bindable). These compiler directives enable developers to build deeply-reactive applications with automatic dependency tracking and efficient updates.",
 'one_line_summary': 'Svelte 5 runes are $ -prefixed compiler keywords that control reactivity, state management, derived values, effects, and component binding.',
 'usage': {'input': 995, 'output': 178, 'details': None}}</code></pre>
</div>
</div>
<div id="cell-22" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> save_doc_tree(doc_dir: DocDirectory, doc_source_root: PathLib, output_root: PathLib, source_name: <span class="bu">str</span>):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Save the processed documentation tree to disk.</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Structure:</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/index.json - high-level metadata</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/metadata.json - directory metadata</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/&lt;page_name&gt;/metadata.json - page metadata</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/&lt;page_name&gt;/summary.md</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/&lt;page_name&gt;/summary_short.md</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/&lt;page_name&gt;/original.md</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/summary.md (for directories)</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">    - output_root/source_name/&lt;dir_name&gt;/summary_short.md (for directories)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_directory(doc_dir: DocDirectory, current_path: PathLib):</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Recursively save directory structure"""</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save relevant pages in this directory</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> page <span class="kw">in</span> doc_dir.pages:</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> page.relevant:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Use better_filename without extension as directory name, replace spaces with underscores</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>            page_name <span class="op">=</span> page.better_filename.rsplit(<span class="st">'.'</span>, <span class="dv">1</span>)[<span class="dv">0</span>] <span class="cf">if</span> <span class="st">'.'</span> <span class="kw">in</span> page.better_filename <span class="cf">else</span> page.better_filename</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>            page_name <span class="op">=</span> page_name.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>            page_dir <span class="op">=</span> current_path <span class="op">/</span> page_name</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>            page_dir.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Write summary files</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>            (page_dir <span class="op">/</span> <span class="st">"summary.md"</span>).write_text(page.summary_markdown)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>            (page_dir <span class="op">/</span> <span class="st">"summary_short.md"</span>).write_text(page.short_summary_markdown)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Copy original file</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>            original_file <span class="op">=</span> doc_source_root <span class="op">/</span> page.original_path</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> original_file.exists():</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>                shutil.copy2(original_file, page_dir <span class="op">/</span> <span class="st">"original.md"</span>)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save page metadata (only one-line summary)</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>            page_metadata <span class="op">=</span> {</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">"filename"</span>: page.filename,</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">"original_path"</span>: page.original_path,</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">"better_filename"</span>: page.better_filename,</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">"one_line_summary"</span>: page.one_line_summary_txt,</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">"usage"</span>: {</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"input"</span>: page.usage.<span class="bu">input</span>,</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"output"</span>: page.usage.output,</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>            (page_dir <span class="op">/</span> <span class="st">"metadata.json"</span>).write_text(json.dumps(page_metadata, indent<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save directory summaries and metadata if this directory has relevant content</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> doc_dir.short_summary:</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>            (current_path <span class="op">/</span> <span class="st">"summary.md"</span>).write_text(doc_dir.short_summary)</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>            (current_path <span class="op">/</span> <span class="st">"summary_short.md"</span>).write_text(doc_dir.one_line_summary <span class="kw">or</span> <span class="st">""</span>)</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save directory metadata (only one-line summary and relevant pages)</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>            relevant_pages <span class="op">=</span> [page <span class="cf">for</span> page <span class="kw">in</span> doc_dir.pages <span class="cf">if</span> page.relevant]</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>            relevant_subdirs <span class="op">=</span> [subdir <span class="cf">for</span> subdir <span class="kw">in</span> doc_dir.subdirs.values() <span class="cf">if</span> subdir.short_summary <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>]</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>            dir_metadata <span class="op">=</span> {</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">"name"</span>: doc_dir.name,</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>                <span class="st">"path"</span>: doc_dir.path,</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">"better_name"</span>: doc_dir.better_name,</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">"one_line_summary"</span>: doc_dir.one_line_summary,</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">"usage"</span>: {</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"input"</span>: doc_dir.usage.<span class="bu">input</span> <span class="cf">if</span> doc_dir.usage <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"output"</span>: doc_dir.usage.output <span class="cf">if</span> doc_dir.usage <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>                } <span class="cf">if</span> doc_dir.usage <span class="cf">else</span> <span class="va">None</span>,</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pages"</span>: [</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>                    {</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"filename"</span>: page.filename,</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"better_filename"</span>: page.better_filename,</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> page <span class="kw">in</span> relevant_pages</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">"subdirs"</span>: [</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>                    {</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"name"</span>: subdir.name,</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"better_name"</span>: subdir.better_name,</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> subdir <span class="kw">in</span> relevant_subdirs</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>            (current_path <span class="op">/</span> <span class="st">"metadata.json"</span>).write_text(json.dumps(dir_metadata, indent<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Recursively save subdirectories</span></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> subdir <span class="kw">in</span> doc_dir.subdirs.values():</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> subdir.short_summary:  <span class="co"># Skip directories with no relevant content</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Use better_name for subdirectory, replace spaces with underscores</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>            subdir_name <span class="op">=</span> (subdir.better_name <span class="kw">or</span> subdir.name).replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>            subdir_path <span class="op">=</span> current_path <span class="op">/</span> subdir_name</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>            subdir_path.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>            save_directory(subdir, subdir_path)</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create output directory (clear it first if it exists)</span></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> output_root <span class="op">/</span> source_name</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> output_dir.exists():</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>        shutil.rmtree(output_dir)</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>    output_dir.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save the directory structure</span></span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>    root_name <span class="op">=</span> (doc_dir.better_name <span class="kw">or</span> <span class="st">"root"</span>).replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>    root_path <span class="op">=</span> output_dir <span class="cf">if</span> root_name <span class="op">==</span> <span class="st">"root"</span> <span class="cf">else</span> output_dir <span class="op">/</span> root_name</span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>    root_path.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>    save_directory(doc_dir, root_path)</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create index.json with high-level metadata only</span></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a>    total_usage <span class="op">=</span> calculate_total_usage(doc_dir)</span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>    index_data <span class="op">=</span> {</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>        <span class="st">"source_name"</span>: source_name,</span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>        <span class="st">"root_directory"</span>: {</span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>            <span class="st">"name"</span>: doc_dir.name,</span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>            <span class="st">"better_name"</span>: doc_dir.better_name,</span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>            <span class="st">"path"</span>: doc_dir.path,</span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>            <span class="st">"one_line_summary"</span>: doc_dir.one_line_summary,</span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>        <span class="st">"usage"</span>: {</span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">"input_tokens"</span>: total_usage.<span class="bu">input</span>,</span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">"output_tokens"</span>: total_usage.output,</span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">"total_tokens"</span>: total_usage.<span class="bu">input</span> <span class="op">+</span> total_usage.output,</span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a>        <span class="st">"statistics"</span>: {</span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">"total_pages"</span>: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> _ <span class="kw">in</span> iter_pages(doc_dir)),</span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">"relevant_pages"</span>: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> p <span class="kw">in</span> iter_pages(doc_dir) <span class="cf">if</span> p.relevant),</span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">"total_directories"</span>: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> _ <span class="kw">in</span> iter_directories(doc_dir)),</span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">"relevant_directories"</span>: <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> d <span class="kw">in</span> iter_directories(doc_dir) <span class="cf">if</span> d.short_summary),</span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a>    (output_dir <span class="op">/</span> <span class="st">"index.json"</span>).write_text(json.dumps(index_data, indent<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Saved documentation to: </span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Total pages: </span><span class="sc">{</span>index_data[<span class="st">'statistics'</span>][<span class="st">'total_pages'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Relevant pages: </span><span class="sc">{</span>index_data[<span class="st">'statistics'</span>][<span class="st">'relevant_pages'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Total directories: </span><span class="sc">{</span>index_data[<span class="st">'statistics'</span>][<span class="st">'total_directories'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-140"><a href="#cb27-140" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Relevant directories: </span><span class="sc">{</span>index_data[<span class="st">'statistics'</span>][<span class="st">'relevant_directories'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-141"><a href="#cb27-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-142"><a href="#cb27-142" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> iter_pages(doc_dir: DocDirectory):</span>
<span id="cb27-143"><a href="#cb27-143" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Iterator over all pages in the tree"""</span></span>
<span id="cb27-144"><a href="#cb27-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> doc_dir.pages</span>
<span id="cb27-145"><a href="#cb27-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subdir <span class="kw">in</span> doc_dir.subdirs.values():</span>
<span id="cb27-146"><a href="#cb27-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="cf">from</span> iter_pages(subdir)</span>
<span id="cb27-147"><a href="#cb27-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-148"><a href="#cb27-148" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> iter_directories(doc_dir: DocDirectory):</span>
<span id="cb27-149"><a href="#cb27-149" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Iterator over all directories in the tree"""</span></span>
<span id="cb27-150"><a href="#cb27-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subdir <span class="kw">in</span> doc_dir.subdirs.values():</span>
<span id="cb27-151"><a href="#cb27-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> subdir</span>
<span id="cb27-152"><a href="#cb27-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="cf">from</span> iter_directories(subdir)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-23" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the processed documentation tree</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>save_doc_tree(doc_tree, doc_dir_path, settings.output_dir, source.name)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved documentation to: ../processed_documents/sveltejs-svelte
  Total pages: 10
  Relevant pages: 9
  Total directories: 1
  Relevant directories: 1</code></pre>
</div>
</div>
<div id="cell-24" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View a sample of the index.json structure</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>index_path <span class="op">=</span> settings.output_dir <span class="op">/</span> source.name <span class="op">/</span> <span class="st">"index.json"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> index_path.exists():</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(index_path) <span class="im">as</span> f:</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        index_data <span class="op">=</span> json.load(f)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show a preview of the structure</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Index.json structure preview:"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Source: </span><span class="sc">{</span>index_data[<span class="st">'source_name'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Root directory: </span><span class="sc">{</span>index_data[<span class="st">'root_directory'</span>]<span class="sc">.</span>get(<span class="st">'better_name'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"One-line summary: </span><span class="sc">{</span>index_data[<span class="st">'root_directory'</span>]<span class="sc">.</span>get(<span class="st">'one_line_summary'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Statistics:"</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> index_data.get(<span class="st">'statistics'</span>, {}).items():</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Usage:"</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> index_data.get(<span class="st">'usage'</span>, {}).items():</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show first page metadata if available</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    subdirs <span class="op">=</span> index_data.get(<span class="st">'root_directory'</span>, {}).get(<span class="st">'subdirs'</span>, {})</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> subdirs:</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        first_subdir <span class="op">=</span> <span class="bu">list</span>(subdirs.values())[<span class="dv">0</span>]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        pages <span class="op">=</span> first_subdir.get(<span class="st">'pages'</span>, [])</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pages:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>            first_page <span class="op">=</span> pages[<span class="dv">0</span>]</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample page metadata:"</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  Original: </span><span class="sc">{</span>first_page<span class="sc">.</span>get(<span class="st">'filename'</span>)<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>first_page<span class="sc">.</span>get(<span class="st">'better_filename'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  Summary: </span><span class="sc">{</span>first_page<span class="sc">.</span>get(<span class="st">'one_line_summary'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  Relevant: </span><span class="sc">{</span>first_page<span class="sc">.</span>get(<span class="st">'relevant'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  Usage: </span><span class="sc">{</span>first_page<span class="sc">.</span>get(<span class="st">'usage'</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index.json structure preview:
Source: sveltejs-svelte

Root directory: svelte-reactivity-system
One-line summary: Svelte 5 runes are $ -prefixed compiler keywords that control reactivity, state management, derived values, effects, and component binding.

Statistics:
  total_pages: 10
  relevant_pages: 9
  total_directories: 1
  relevant_directories: 1

Usage:
  input_tokens: 28,530
  output_tokens: 5,536
  total_tokens: 34,066</code></pre>
</div>
</div>
<div id="cell-25" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # View a sample directory summary</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># def print_tree_summaries(doc_dir: DocDirectory, indent=0):</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     prefix = "  " * indent</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     display_name = doc_dir.better_name or doc_dir.name</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(f"{prefix}📁 {display_name} ({doc_dir.path or 'root'})")</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     if doc_dir.one_line_summary:</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(f"{prefix}   → {doc_dir.one_line_summary}")</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Print relevant pages</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     relevant_pages = [p for p in doc_dir.pages if p.relevant]</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     if relevant_pages:</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(f"{prefix}   Pages: {len(relevant_pages)} relevant / {len(doc_dir.pages)} total")</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Recursively print subdirectories</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     for subdir in doc_dir.subdirs.values():</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#         print_tree_summaries(subdir, indent + 1)</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print_tree_summaries(doc_tree)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/xl0\.github\.io\/lovely-docs");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/xl0/lovely-docs/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>